drop tcp any any -> any $HTTP_PORTS (msg:"WebLogic wls-wsat RCE (CVE-2017-10271,CVE-2017-10352,CVE-2017-3506)"; flow: established, to_server; content:"POST";http_method;content: "wls-wsat"; nocase; http_uri; pcre: "/(java.beans.XMLDecoder)|(defineClass)|(java.lang.ProcessBuilder)/P"; reference: cve, 2017-10271;reference: cve, 2017-3506;reference: cve, 2017-10352;classtype:shellcode-detect; sid: 10000001; rev: 1; )
drop tcp any any -> any $HTTP_PORTS (msg:"Weblogic _async RCE(CVE-2019-2725)"; flow: established, to_server; flowbits:set,10000002; content: "POST"; nocase; http_method; content: "wls-wsat"; http_uri; pcre:"/(oracle\.toplink\.internal\.sessions\.UnitOfWorkChangeSet|org\.slf4j\.ext\.EventData|com\.sun\.rowset\.JdbcRowSetImpl)/iP"; content: "<class>";reference: cve, 2019-2725; classtype:shellcode-detect;sid: 10000002; rev: 2;)
drop tcp any any -> any $HTTP_PORTS (msg:"Weblogic _async RCE(CVE-2019-2725)"; flow: established, to_server; flowbits:set,10000002; content: "POST"; nocase; http_method; content: "async"; http_uri; pcre: "/(oracle\.toplink\.internal\.sessions\.UnitOfWorkChangeSet|org\.slf4j\.ext\.EventData)/iP"; content: "<class>";reference: cve, 2019-2725; classtype:shellcode-detect;sid: 10000003; rev: 2;)
drop tcp any $HTTP_PORTS -> any any (msg:"Weblogic _async RCE(CVE-2019-2725)"; flowbits:isset,10000002; content: "200"; http_stat_code; reference: cve, 2019-2725; classtype:shellcode-detect;sid: 10000004; rev: 2;)
drop tcp any any -> any $HTTP_PORTS (msg:"Weblogic wls-wsat RCE (CVE-2019-2729)"; flow: established, to_server; content: "POST"; nocase; http_method; content: "wls-wsat"; http_uri; pcre: "/(oracle\.toplink\.internal\.sessions\.UnitOfWorkChangeSet|org\.slf4j\.ext\.EventData)/iP"; pcre: "/<array method=.+>/iP";reference: cve, 2019-2729;classtype:shellcode-detect;sid: 10000005; rev: 1;)
drop tcp any any -> any $HTTP_PORTS (msg:"Weblogic wls-wsat RCE (CVE-2019-2729)"; flow: established, to_server; content: "POST"; nocase; http_method; content: "async"; http_uri; pcre: "/(oracle\.toplink\.internal\.sessions\.UnitOfWorkChangeSet|org\.slf4j\.ext\.EventData)/iP"; pcre: "/<array method=.+>/iP";reference: cve, 2019-2729;classtype:shellcode-detect;sid: 10000006; rev: 1;)
drop tcp any any -> any $HTTP_PORTS (msg:"IPTV Smarters WEB TV PLAYER File Upload (CVE-2020-9380)"; content:"POST"; http_method; content:"/includes/ajax-control.php"; http_uri; content:"logoImage"; http_client_body; pcre:"/filename=\".+\.php\"/iP"; classtype:shellcode-detect; reference:cve,2020-9380; sid:10000007; rev:1;)
drop udp any any -> any 53 (msg:"bs.unaout.com request"; flow:to_server; content:"|02|bs|06|unaout|03|com"; nocase; offset:12; depth:14; classtype:trojan-activity; sid:10000008; rev:1;)
drop udp any any -> any 53 (msg:"junfac.com request"; flow:to_server; content:"|06|junfac|03|com"; nocase; classtype:trojan-activity; sid:10000009; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg: "Weblogic RCE (CVE-2019-2618)"; flow: established, to_server; flowbits:set,30000007;content: "POST"; nocase; http_method; content: "/bea_wls_deployment_internal/DeploymentService"; http_uri; content: "app_upload"; http_header; content: "_WL_internal"; http_header; content: "bea_wls_"; http_header; distance: 0; reference: cve, 2019-2618; reference: url, github.com/jas502n/cve-2019-2618/blob/master/cve-2019-2618.py; reference: url, github.com/ptresearch/AttackDetection; classtype:shellcode-detect; sid: 30000007; rev: 1;)
drop tcp any $HTTP_PORTS -> any any (msg: "Weblogic RCE (CVE-2019-2618) resp"; flow: established, to_client; flowbits:isset,30000007;content: "200"; http_stat_code; reference: cve, 2019-2618; reference: url, github.com/jas502n/cve-2019-2618/blob/master/cve-2019-2618.py; reference: url, github.com/ptresearch/AttackDetection; classtype:shellcode-detect; sid: 30000008; rev: 1;)
drop tcp any any -> any $HTTP_PORTS (msg: "ThinkPHP5 5.0.22/5.1.29 RCE"; flow:to_server; content:"GET"; http_method; content:"="; http_uri; pcre:"/(?i)(think%5CLoader)|(file_put_contents)|(Composer%5CAutoload%5CComposerStaticInit289837ff5d5ea8a00f5cc97a07c04561)|(think%5CError)|(think%5CContainer)|(think%5CApp)|(think%5CEnv)|(think%5CConfig)|(think%5CHook)|(think%5CFacade)|(think%5Cfacade%5CEnv)|(env)|(think%5CDb)|(think%5CLang)|(think%5CRequest)|(think%5CLog)|(think%5Clog%5Cdriver%5CFile)|(think%5Cfacade%5CRoute)|(route)|(think%5CRoute)|(think%5Croute%5CRule)|(think%5Croute%5CRuleGroup)|(think%5Croute%5CDomain)|(think%5Croute%5CRuleItem)|(think%5Croute%5CRuleName)|(think%5Croute%5CDispatch)|(think%5Croute%5Cdispatch%5CUrl)|(think%5Croute%5Cdispatch%5CModule)|(think%5CMiddleware)|(think%5CCookie)|(think%5CView)|(think%5Cview%5Cdriver%5CThink)|(think%5CTemplate)|(think%5Ctemplate%5Cdriver%5CFile)|(think%5CSession)|(think%5CDebug)|(think%5CCache)|(think%5Ccache%5CDriver)|(think%5Ccache%5Cdriver%5CFile)|(think%5CRoute)|(think%5CConfig)|(think%5CError)|(think%5CApp)|(think%5CRequest)|(think%5CHook)|(think%5CEnv)|(think%5CLang)|(think%5CLog)|(hink%5CLoader)(?i)/i"; classtype:shellcode-detect; sid:30000060;rev:1;)
drop tcp any any -> any any (msg:"antsword php webshell detected"; content:"%40ini_set(%22display_errors%22%2C%20%220%22"; http_client_body; classtype:trojan-activity; sid:30000144; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg:"tongda oa file upload"; flow: established,to_server; content: "POST"; http_method; content: "/ispirit/im/upload.php"; http_uri; content: "multipart/form-data"; http_header; content: "name=\"P\""; http_client_body; classtype:shellcode-detect; sid: 30000146; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg:"ThinkPHP5 5.0.23 RCE"; flow: established, to_server; flowbits: set, 30000023; content: "POST"; http_method; content: "s=captcha"; nocase; http_uri; content: "_method=__construct"; nocase; http_client_body; content: "filter[]=system"; nocase; http_client_body; content: "method=get"; nocase; http_client_body; content: "server[REQUEST_METHOD]="; nocase; http_client_body; reference:url, github.com/top-think/framework/commit/4a4b5e64fa4c46f851b4004005bff5f3196de003; classtype:shellcode-detect; sid:30000023; rev: 1; )
drop tcp any $HTTP_PORTS -> any any (msg:"ThinkPHP5 5.0.23 RCE resp"; flow: established, to_client; flowbits: isset, 30000023; content: "200"; http_stat_code; reference:url, github.com/top-think/framework/commit/4a4b5e64fa4c46f851b4004005bff5f3196de003; classtype:shellcode-detect; sid:30000024; rev: 1; )
drop tcp any any -> any $HTTP_PORTS (msg:"weblogic ssrf"; flow:to_server; content:"uddiexplorer/SearchPublicRegistries.jsp"; http_uri; nocase; content:"operator"; pcre:"/((\\d{1,3}\\.){3}\\d{1,3})|(([A-Za-z0-9]{1,}\\.){1,}[a-zA-Z0-9]{2,})/i"; classtype:network-scan; sid:30000152; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg:"weblogic ssrf uddiexplorer"; flow:to_server; content:"uddiexplorer"; http_uri; flowbits:set,weblogicssrf; flowbits:noalert; classtype:network-scan; sid:30000153; rev:1;)
drop tcp any $HTTP_PORTS -> any any (msg:"weblogic ssrf resp"; flow:to_client; content:"An error has occurred"; nocase; flowbits:isset,weblogicssrf; classtype:network-scan; sid:30000154; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg:"weblogic RCE CVE-2020-2551"; flow:established,to_server; content:"GIOP"; content:"NameService"; distance:0; content:"weblogic.iiop.ProxyDesc"; content:"java.rmi.remote"; nocase; pcre:"/ldap:\/\/(?:[0-9]{1,3}\.){3}[0-9]{1,3}/i"; classtype:shellcode-detect; reference:cve,2020-2551; sid:30000155; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg:"GIOP detected"; flow:to_server; flowbits:set,weblogic_0day_20200326_1; flowbits:noalert; content:"GIOP"; classtype:shellcode-detect; sid:30000156; rev:1;)
drop tcp any $HTTP_PORTS -> any any (msg:"weblogic rce 0day 20200326 resp"; flow:to_client; flowbits:isset,weblogic_0day_20200326_1; content:"weblogic.cosnaming.NameService"; nocase; content:"naming/NamingContextAny"; nocase; distance:0; classtype:shellcode-detect; sid:30000157; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg:"weblogic rce 0day 20200326"; flow:to_server;flowbits:isset,weblogic_0day_20200326_1; content:"naming/NamingContextAny"; nocase; pcre:"/ldap|rmi/"; classtype:shellcode-detect; sid:30000158; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"nexus3 OSS coreui_User RCE (CVE-2020-10204)"; flow:to_server; content:"POST"; http_method; content:"service/extdirect"; http_uri; nocase; content:"coreui_User";http_client_body; pcre:"/(java.lang.Runtime)|(java.lang.ProcessBuilder)/iP"; pcre:"/(invoke)|(getMethods)/iP"; classtype:shellcode-detect; sid:30000159; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"nexus3 OSS EL RCE (CVE-2020-10204)"; flow:to_server; content:"POST"; http_method; content:"service/rest/beta/repositories/go/group"; http_uri; nocase; content:"Content-Type: application/json"; http_header; content:"memberNames"; http_client_body; content:"$"; http_client_body; distance:0; classtype:shellcode-detect; sid:30000160; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"nexus3 OSS cleanup_CleanupPolicy RCE (CVE-2020-10199)"; flow:to_server; content:"POST"; http_method; content:"service/extdirect"; http_uri; nocase; content:"cleanup_CleanupPolicy"; http_client_body; pcre:"/(java.lang.Runtime)|(java.lang.ProcessBuilder)/iP"; pcre:"/(invoke)|(getMethods)/iP"; classtype:shellcode-detect; sid:30000161; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -sS window 2048"; fragbits:!D; dsize:0; flags:S,12; ack:0; window:2048; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000537; classtype:network-scan; sid:2000537; rev:8; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -sO"; dsize:0; ip_proto:21; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000536; classtype:network-scan; sid:2000536; rev:7; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -sA (1)"; fragbits:!D; dsize:0; flags:A,12; window:1024; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000538; classtype:network-scan; sid:2000538; rev:8; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -sA (2)"; fragbits:!D; dsize:0; flags:A,12; window:3072; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000540; classtype:network-scan; sid:2000540; rev:8; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -f -sF"; fragbits:!M; dsize:0; flags:F,12; ack:0; window:2048; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000543; classtype:network-scan; sid:2000543; rev:7; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -f -sN"; fragbits:!M; dsize:0; flags:0,12; ack:0; window:2048; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000544; classtype:network-scan; sid:2000544; rev:7; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -f -sX"; fragbits:!M; dsize:0; flags:FPU,12; ack:0; window:2048; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000546; classtype:network-scan; sid:2000546; rev:7; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"PING NMAP"; dsize:0; itype:8; reference:arachnids,162; classtype:network-scan; sid:2100469; rev:4; metadata:created_at 2010_09_23, updated_at 2010_09_23;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"NMAP SQL Spider Scan"; flow:established,to_server; content:"GET"; http_method; content:" OR sqlspider"; http_uri; reference:url,nmap.org/nsedoc/scripts/sql-injection.html; classtype:network-scan; sid:2013778; rev:2; metadata:created_at 2011_10_19, updated_at 2011_10_19;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"nmap TCP"; ack:0; flags:A,12; flow:stateless; reference:arachnids,28; classtype:network-scan; sid:2100628; rev:8; metadata:created_at 2010_09_23, updated_at 2010_09_23;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"nmap XMAS"; flow:stateless; flags:FPU,12; reference:arachnids,30; classtype:network-scan; sid:2101228; rev:8; metadata:created_at 2010_09_23, updated_at 2010_09_23;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"nmap fingerprint attempt"; flags:SFPU; flow:stateless; reference:arachnids,05; classtype:network-scan; sid:2100629; rev:7; metadata:created_at 2010_09_23, updated_at 2010_09_23;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)"; flow:to_server,established; content:"Mozilla/5.0 (compatible|3b| Nmap Scripting Engine"; nocase; http_user_agent; depth:46; reference:url,doc.emergingthreats.net/2009358; classtype:network-scan; sid:2009358; rev:5; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -sS window 1024"; fragbits:!D; dsize:0; flags:S,12; ack:0; window:1024; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2009582; classtype:network-scan; sid:2009582; rev:3; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -sS window 3072"; fragbits:!D; dsize:0; flags:S,12; ack:0; window:3072; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2009583; classtype:network-scan; sid:2009583; rev:3; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -sS window 4096"; fragbits:!D; dsize:0; flags:S,12; ack:0; window:4096; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2009584; classtype:network-scan; sid:2009584; rev:2; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"NMAP SIP Version Detect OPTIONS Scan"; flow:established,to_server; content:"OPTIONS sip|3A|nm SIP/"; depth:19; classtype:network-scan; sid:2018317; rev:1; metadata:created_at 2014_03_25, updated_at 2014_03_25;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 5060:5061 (msg:"NMAP SIP Version Detection Script Activity"; content:"Via|3A| SIP/2.0/TCP nm"; content:"From|3A| <sip|3A|nm@nm"; within:150; fast_pattern; classtype:network-scan; sid:2018318; rev:1; metadata:created_at 2014_03_25, updated_at 2014_03_25;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -f -sV"; fragbits:!M; dsize:0; flags:S,12; ack:0; window:2048; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000545; classtype:network-scan; sid:2000545; rev:8; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert udp $EXTERNAL_NET 10000: -> $HOME_NET 10000: (msg:"NMAP OS Detection Probe"; dsize:300; content:"CCCCCCCCCCCCCCCCCCCC"; fast_pattern:only; content:"CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC"; depth:255; content:"CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC"; within:45; classtype:network-scan; sid:2018489; rev:3; metadata:created_at 2014_05_20, updated_at 2014_05_20;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"Nmap Scripting Engine User-Agent Detected (Nmap NSE)"; flow:to_server,established; content:"Nmap NSE"; http_user_agent; reference:url,doc.emergingthreats.net/2009359; classtype:network-scan; sid:2009359; rev:4; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert tcp any any -> $HOME_NET any (msg:"Nmap NSE Heartbleed Request"; flow:established,to_server; content:"|18 03|"; depth:2; byte_test:1,<,4,2; content:"|01|"; offset:5; depth:1; byte_test:2,>,2,3; byte_test:2,>,200,6; content:"|40 00|Nmap ssl-heartbleed"; fast_pattern:2,19; classtype:network-scan; sid:2021023; rev:1; metadata:created_at 2015_04_28, updated_at 2015_04_28;)
alert tcp $HOME_NET any -> any any (msg:"Nmap NSE Heartbleed Response"; flow:established,from_server; content:"|18 03|"; depth:2; byte_test:1,<,4,2; byte_test:2,>,200,3; content:"|40 00|Nmap ssl-heartbleed"; fast_pattern:2,19; classtype:network-scan; sid:2021024; rev:1; metadata:created_at 2015_04_28, updated_at 2015_04_28;)
alert tcp $HOME_NET any -> any any (msg:"Possible Nmap User-Agent Observed"; flow:to_server,established; content:"|20|Nmap"; http_user_agent; fast_pattern; metadata: former_category SCAN; classtype:network-scan; sid:2024364; rev:3; metadata:affected_product Any, attack_target Client_and_Server, deployment Perimeter, signature_severity Audit, created_at 2017_06_08, performance_impact Low, updated_at 2017_06_13;)
drop tcp any any -> any $HTTP_PORTS (msg:"caidao php webshell detected"; content:"POST"; http_method; content:"array_map"; http_client_body; content:"$xx("; http_client_body; distance:10; base64_decode:bytes 41, offset 1, relative; base64_data; content:"ini_set("; content:"display_errors"; classtype:trojan-activity; sid:30000145; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg:"bingxie php shell detected"; flow:established,to_server; flowbits:set,bingxie_php_resp; flowbits:noalert; content: "GET"; http_method; content:"php?pass"; http_uri; pcre:"/\=[0-9]{0,3}$/I"; classtype:trojan-activity; sid: 30000147; rev:1;)
drop tcp any $HTTP_PORTS -> any any (msg:"bingxie php shell detected resp"; flow:established,to_client; flowbits:set,bingxie_php_resp; flowbits:noalert; content:"Content-Length: 16"; http_header; pcre:"/[0-9a-zA-Z]{16}$/"; classtype:trojan-activity; sid:30000148; rev:1;)
drop tcp any $HTTP_PORTS -> any any (msg:"bingxie php shell detected resp"; flow:established,to_client; flowbits:isset,bingxie_php_req; flowbits:isset,bingxie_php_resp; content:"Content-Type: text/html"; http_header; pcre:"/\r\n\r\n[a-zA-Z\d\+\/]{10,}/"; classtype:trojan-activity; sid:30000149; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"疑似struts2 OGNL 远程命令执行"; content:"memberAccess"; nocase; pcre:"/(ProcessBuilder|getRuntime|denyMethodExecution|FileOutputStream|memberAccess)/i"; classtype:shellcode-detect; sid:30000150; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg:"疑似冰蝎3.0 php 木马"; content:"php"; nocase; fast_pattern:only; http_uri; content:"Content-Length: 1112"; nocase; http_header; flowbits:set,bingxie3.0_php_1; flowbits:noalert; classtype:trojan-activity; sid:30000151; rev:1;)
drop tcp any $HTTP_PORTS -> any any (msg:"疑似冰蝎3.0 php 木马"; content:"Content-Length: 128"; http_header; nocase; flowbits:isset,bingxie3.0_php_1; classtype:trojan-activity; sid:30000152; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg:"疑似冰蝎3 PHP HTTP Request"; flow:established,to_server; content:".php"; http_uri; pcre:"/[a-zA-Z0-9+/]{1000,}=/i"; flowbits:set,behinder3; flowbits:noalert; classtype:trojan-activity; sid:30000153; rev:1; metadata:2020_08_28,by_shichangqi;)
drop tcp any $HTTP_PORTS -> any any (msg:"疑似冰蝎3PHP HTTP Response"; flow:established,to_client; content:"200"; http_stat_code; flowbits:isset,behinder3; pcre:"/[a-zA-Z0-9+/]{100,}=/i"; classtype:trojan-activity; sid:30000154; rev:1; metadata:2020_08_28,by_co0ontty;)
drop tcp any any -> any $HTTP_PORTS (msg:"spring cloud path through cve-2019-3799"; flow:to_server,established; content:"GET"; http_method; content:"/foo/default/master/..%252F"; http_raw_uri; reference:cve,2014-0099; classtype:shellcode-detect; sid:30000155; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"用友 nc 6.5 反序列化命令执行 QTVA-2020-1523171"; flow:to_server,established; content:"POST"; http_method; content:"servlet"; nocase; http_uri; content:"DeleteServlet"; nocase; http_uri; pcre:"/(ProcessBuilder|getRuntime|denyMethodExecution|FileOutputStream|memberAccess)/iP"; classtype:web-application-activity; sid:10000369; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"用友 nc 6.5 xxe QTVA-2020-1513598"; flow:to_server,established; content:"POST"; http_method; content:"servlet"; http_uri; nocase; content:"XChangeServlet"; nocase; http_uri; content:"DOCTYPE"; nocase; http_client_body; content:"ENTITY"; nocase; http_client_body; content:"%dtd\;"; nocase; http_client_body; content:"%send\;"; nocase; http_client_body; classtype:web-application-activity; sid:10000368; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"用友 nc 6.5 SQL 注入 QTVA-2020-1516883"; flow:to_server,established; content:"/uapws/service/"; http_uri; content:"soapenv"; http_client_body; content:"<imet:string>"; http_client_body; pcre:"/<imet:string>.+\'.+\-\-<\/imet:string>/iP"; sid:10000367; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"锐捷EWEB网关系统任意命令执行漏洞 QTVA-2020-1536827"; flow:to_server; content:"/guest_auth/guestIsUp.php"; nocase; http_uri; content:"mac"; http_client_body; content:"ip"; http_client_body; pcre:"/.{2,}\ .{2,}/iP"; classtype:web-application-activity; sid:10000371; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"锐捷EWEB网关系统任意命令执行漏洞"; flow:to_server; content:"/guest_auth/smsCheck.php"; nocase; http_uri; content:"type="; http_client_body; pcre:"/\&.{0,}gip.{0,}\=(\d{1,3}\.){3,3}(\d{1,3}).+(%26){2}.{3,}\&/iP"; classtype:web-application-activity; sid:10000370; rev:1;)
