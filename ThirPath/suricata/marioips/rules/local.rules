alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 目录 url"; content:"ls"; http_uri; nocase; classtype:shellcode-detect; sid:60000; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 下载 url"; content:"wget"; http_uri; nocase; classtype:shellcode-detect; sid:60001; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 请求 url"; content:"curl"; http_uri; nocase; classtype:shellcode-detect; sid:60002; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 权限 url"; content:"chmod"; http_uri; nocase; classtype:shellcode-detect; sid:60003; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 用户 url"; content:"whoami"; http_uri; nocase; classtype:shellcode-detect; sid:60004; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 icmp url"; content:"ping"; http_uri; nocase; classtype:shellcode-detect; sid:60005; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 目录 body"; content:"ls"; http_client_body; nocase; classtype:shellcode-detect; sid:60006; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 下载 body"; content:"wget"; http_client_body; nocase; classtype:shellcode-detect; sid:60007; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 请求 body"; content:"curl"; http_client_body; nocase; classtype:shellcode-detect; sid:60008; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 权限 body"; content:"chmod"; http_client_body; nocase; classtype:shellcode-detect; sid:60009; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 用户 body"; content:"whoami"; http_client_body; nocase; classtype:shellcode-detect; sid:60010; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 icmp body"; content:"ping"; http_client_body; nocase; classtype:shellcode-detect; sid:60011; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 目录 header"; content:"ls"; http_header; nocase; classtype:shellcode-detect; sid:60012; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 下载 header"; content:"wget"; http_header; nocase; classtype:shellcode-detect; sid:60013; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 请求 header"; content:"curl"; http_header; nocase; classtype:shellcode-detect; sid:60014; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 权限 header"; content:"chmod"; http_header; nocase; classtype:shellcode-detect; sid:60015; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 用户 header"; content:"whoami"; http_header; nocase; classtype:shellcode-detect; sid:60016; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 icmp header"; content:"ping"; http_header; nocase; classtype:shellcode-detect; sid:60017; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 路由器 HNAP"; content:"HNAP1"; http_uri; nocase; classtype:shellcode-detect; sid:60018; rev:1;)
pass tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"pass tmUnblock.cgi"; content:"tmUnblock.cgi"; http_uri; classtype:shellcode-detect; sid:60024; rev:1;)
pass tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"pass Mozi shell?cd"; content:"shell"; http_uri; content:"Hello, world"; http_header; content:"Mozi"; http_uri; classtype:shellcode-detect; sid:60019; rev:1;)
pass tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"pass Mozi setup.cgi"; content:"setup.cgi?next_file=netgear.cfg"; http_uri; content:"Mozi"; http_uri; classtype:shellcode-detect; sid:60020; rev:1;)
pass tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"pass Mozi HNAP1"; content:"HNAP1"; http_uri; content:"Mozi"; classtype:shellcode-detect; sid:60021; rev:1;)
pass tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"pass api"; content:"/api/vulsearch"; http_uri; classtype:shellcode-detect; sid:60022; rev:1;)
pass tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"pass GponForm/diag_Form"; content:"GponForm/diag_Form?images"; http_uri; classtype:shellcode-detect; sid:60023; rev:1;)
pass tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"pass netgear.cfg"; content:"setup.cgi?next_file=netgear.cfg"; http_uri; classtype:shellcode-detect; sid:60025; rev:1;)
pass tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"pass CONNECT method"; content:"CONNECT"; http_method; classtype:shellcode-detect; sid:60026; rev:1;)
pass tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"pass images.php"; content:"POST"; http_method; content:"images.php"; http_uri; classtype:shellcode-detect; sid:60027; rev:1;)
pass tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"pass shell?cd"; content:"shell?cd"; http_uri; classtype:shellcode-detect; sid:60028; rev:1;)
pass tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"pass cgi-bin/kerbynet"; content:"cgi-bin/kerbynet"; http_uri; classtype:shellcode-detect; sid:60029; rev:1;)
pass tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"pass cgi-bin/mainfunction.cgi"; content:"cgi-bin/mainfunction.cgi"; http_uri; classtype:shellcode-detect; sid:60030; rev:1;)
pass tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"pass get myip.ipip.net"; content:"domain=.ipip.net"; classtype:shellcode-detect; sid:60031; rev:1;)
alert tcp any any -> any any (msg:"Counting Failed Logins"; content:"incorrect"; flowint: username, notset; flowint:username, =, 1; noalert; classtype:attempted-admin; sid:886;)
alert tcp any any -> any any (msg:"More than two Failed Logins!"; content:"incorrect"; flowint: username, isset; flowint:username, +, 1; flowint:username, >, 2; classtype:attempted-admin; sid:887;)
drop tcp any any -> $MY_SSH_SERVER 22 (msg:"Connection to SSH server"; threshold: type threshold, track by_src, count 10, seconds 60,flow:to_server; flags:S,12; classtype:attempted-admin; sid:888;)
pass tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"pass cgi-bin/kerbynet"; content:"cgi-bin/kerbynet"; http_uri; content:"zero"; classtype:shellcode-detect; sid:60024; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg:"ThinkPHP5 5.0.23 RCE"; flow: established, to_server; flowbits: set, 30000023; content: "POST"; http_method; content: "s=captcha"; nocase; http_uri; content: "_method=__construct"; nocase; http_client_body; content: "filter[]=system"; nocase; http_client_body; content: "method=get"; nocase; http_client_body; content: "server[REQUEST_METHOD]="; nocase; http_client_body; reference:url, github.com/top-think/framework/commit/4a4b5e64fa4c46f851b4004005bff5f3196de003; classtype:web-application-attack; sid:30000023; rev: 1; )
drop tcp any $HTTP_PORTS -> any any (msg:"ThinkPHP5 5.0.23 RCE resp"; flow: established, to_client; flowbits: isset, 30000023; content: "200"; http_stat_code; reference:url, github.com/top-think/framework/commit/4a4b5e64fa4c46f851b4004005bff5f3196de003; classtype:web-application-attack; sid:30000024; rev: 1; )
alert tcp any any -> any $HTTP_PORTS (msg:"Nuclei 扫描 - 默认UA"; flow_to_server; content:"Nuclei"; nocase; http_client_body; content:"projectdiscovery"; http_client_body; classtype:network-scan; sid:10000420; rev:1;)
pass tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"pass cgi-bin/mainfunction.cgi"; content:"mainfunction.cgi"; http_uri; classtype:shellcode-detect; sid:60025; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"疑似 webshell 存活探测"; flow:to_server; content:"ph"; nocase; http_uri; content:"die"; http_client_body; within:10; content:"md5"; http_client_body; pcre:"/die\((\@|%40)md5\([a-z0-9A-Z]{1,}\)\)/i"; classtype:trojan-activity; sid:313106; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"INDICATOR-SCAN fastjson 探测"; flow:to_server; content:"java.net"; http_client_body; content:"val"; http_client_body; pcre:"/{\".+\":{\"@type\":\"(java\.net\.Inet6Address|java\.net\.Inet4Address|java\.net\.InetAddress)\"\,\"val\"\:\"[\w.]+\..+"\}\}/iP"; classtype:network-scan; sid:10000456; rev:1; metadata:2020_11_03,by_co0ontty;)
alert tcp any any -> any $HTTP_PORTS (msg:"奇安信云扫 jiance.qianxin.com"; flow:to_server; content:"jiance.qianxin.com"; classtype:network-scan; sid:313107; rev:1; metadata:2020_11_03,by_co0ontty;)
alert tcp any any -> any $HTTP_PORTS (msg:"SaltStack CVE-2020-16846 命令注入漏洞 CVE-2020-25592 验证绕过漏洞"; flow:to_server; content:"POST"; http_method; content:"run"; http_uri; content:"application/x-www-form-urlencoded"; http_header; content:"client=ssh"; http_client_body; content:"ssh_priv"; http_client_body; fast_pattern; pcre:"/((%26|&).+(%26|&)(%26|&))/iP"; classtype:web-application-attack; sid:10000461; rev:1; metadata:2020_11_05,by_co0ontty;)
pass tcp any any -> any any (msg:"系统 API 放行规则 规则处理"; content:"/api/rules"; http_uri; sid:6032; rev:1)
pass tcp any any -> any any (msg:"系统 API 放行规则 数据分析"; content:"/api/map"; http_uri; sid:6033; rev:1)
pass tcp any any -> any any (msg:"系统 API 放行规则 数据提交"; content:"/api/evefile"; http_uri; sid:6034; rev:1)
pass tcp any any -> any any (msg:"系统 API 放行规则 安装脚本"; content:"install.sh"; http_uri; sid:6035; rev:1)
pass tcp any any -> any any (msg:"系统 API 放行规则 规则下发"; content:"local.rules"; http_uri; sid:6036; rev:1)
pass tcp any any -> any any (msg:"系统 API 放行规则 安装包下发"; content:"marioips.tar.gz"; http_uri; sid:6037; rev:1)
pass tcp any 27017 -> any any (msg:"系统 API 放行规则 数据库读取"; content:"payload_printable"; http_uri; sid:6038; rev:1)